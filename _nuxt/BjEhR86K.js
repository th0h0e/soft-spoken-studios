import{g as W,R as j,h as b,c as y,o as p,w as m,Q as U,$ as S,ai as z,b3 as V,b4 as B,U as N,r as O,S as T,d,x as s,ay as L,T as R,a1 as D,a4 as G,Y as A,b5 as H,b6 as X,V as Z,b7 as F,G as Q}from"./DYvv4Hww.js";import{D as Y,a as J,b as K}from"./Dp93MUn4.js";import{u as ee,f as te,a as ae,m as x,r as C,d as oe,M as _}from"./C1iqG3Ev.js";import{c as q,b as ne}from"./C8Jy028z.js";import"./3JjJcofp.js";function se(i){const e=new WeakMap,h=ee();function g(r){if(i.mode!=="popLayout")return;const u=r.element,a=u.offsetParent,f=a instanceof HTMLElement&&a.offsetWidth||0,o={height:u.offsetHeight||0,width:u.offsetWidth||0,top:u.offsetTop,left:u.offsetLeft,right:0};o.right=f-o.width-o.left;const n=i.anchorX==="left"?`left: ${o.left}`:`right: ${o.right}`;r.element.dataset.motionPopId=r.id;const t=document.createElement("style");h.value.nonce&&(t.nonce=h.value.nonce),e.set(r,t),document.head.appendChild(t),t.sheet&&t.sheet.insertRule(`
    [data-motion-pop-id="${r.id}"] {
      position: absolute !important;
      width: ${o.width}px !important;
      height: ${o.height}px !important;
      top: ${o.top}px !important;
      ${n}px !important;
      }
      `)}function v(r){const u=e.get(r);u&&(e.delete(r),te.render(()=>{document.head.removeChild(u)}))}return{addPopStyle:g,removePopStyle:v,styles:e}}function M(i){return Promise.resolve().then(()=>{i()})}const ie=W({name:"AnimatePresence",inheritAttrs:!0,__name:"AnimatePresence",props:{mode:{default:"sync"},initial:{type:Boolean,default:!0},as:{},custom:{},onExitComplete:{},anchorX:{default:"left"}},setup(i){const e=i;ae(e);const{addPopStyle:h,removePopStyle:g,styles:v}=se(e);function r(n){let t=n;for(;t;){if(x.get(t))return t;t=t.firstElementChild}return null}function u(n){const t=x.get(n);t&&(g(t),t.isVShow=!0,C(n),M(()=>{t.setActive("exit",!1)}))}const a=new Map;j(()=>{a.clear()});function f(n,t){var w;const l=r(n),c=x.get(l);if(!l||!c){t(),a.size===0&&((w=e.onExitComplete)==null||w.call(e));return}a.set(l,!0),C(l),h(c);function P(k){var E,$;if((E=k?.detail)!=null&&E.isExit){const I=c.visualElement.projection;if(I?.animationProgress>0&&!c.isSafeToRemove&&!c.isVShow)return;C(l),a.delete(l),a.size===0&&(($=e.onExitComplete)==null||$.call(e)),v.has(c)?g(c):c.willUpdate("done"),t(),l.isConnected||c.unmount(!0)}}M(()=>{c.setActive("exit",!0),oe.set(l,P),l.addEventListener("motioncomplete",P)})}const o=b(()=>e.mode!=="wait"?{tag:e.as}:{mode:e.mode==="wait"?"out-in":void 0});return(n,t)=>(p(),y(z(n.mode==="wait"?V:B),S({css:!1},o.value,{appear:"",onEnter:u,onLeave:f}),{default:m(()=>[U(n.$slots,"default")]),_:3},16))}}),le={slots:{base:"rounded-md w-full",overlay:"fixed inset-0 bg-default/75 backdrop-blur-sm will-change-opacity",content:"fixed inset-0 flex items-center justify-center cursor-zoom-out focus:outline-none",zoomedImage:"w-full h-auto max-w-[95vw] max-h-[95vh] object-contain rounded-md"},variants:{zoom:{true:"will-change-transform"},open:{true:""}},compoundVariants:[{zoom:!0,open:!1,class:"cursor-zoom-in"}]},re=["onClick"],pe=Object.assign({inheritAttrs:!1},{__name:"ProseImg",props:{src:{type:String,required:!0},alt:{type:String,required:!0},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},class:{type:null,required:!1},zoom:{type:Boolean,required:!1,default:!0},ui:{type:null,required:!1}},setup(i){const e=i,h=N(),[g,v]=q(),[r,u]=q(),a=O(!1),f=b(()=>A({extend:A(le),...h.ui?.prose?.img||{}})({zoom:e.zoom,open:a.value})),o=b(()=>{if(e.src?.startsWith("/")&&!e.src.startsWith("//")){const t=H(X(Z().app.baseURL));if(t!=="/"&&!e.src.startsWith(t))return F(t,e.src)}return e.src}),n=b(()=>`${o.value}::${Q()}`);return e.zoom&&ne(window,"scroll",()=>{a.value=!1}),(t,w)=>(p(),T(G,null,[d(s(g),null,{default:m(()=>[(p(),y(z(s(L)),S({src:o.value,alt:i.alt,width:i.width,height:i.height},t.$attrs,{class:f.value.base({class:[e.ui?.base,e.class]})}),null,16,["src","alt","width","height","class"]))]),_:1}),d(s(r),null,{default:m(()=>[(p(),y(z(s(L)),S({src:o.value,alt:i.alt},t.$attrs,{class:f.value.zoomedImage({class:[e.ui?.zoomedImage]})}),null,16,["src","alt","class"]))]),_:1}),i.zoom?(p(),y(s(K),{key:0,open:a.value,"onUpdate:open":w[0]||(w[0]=l=>a.value=l),modal:!1},{default:m(({close:l})=>[d(s(Y),{"as-child":""},{default:m(()=>[d(s(_),{"layout-id":n.value,"as-child":"",transition:{type:"spring",bounce:.15,duration:.5,ease:"easeInOut"}},{default:m(()=>[d(s(v))]),_:1},8,["layout-id"])]),_:1}),d(s(J),null,{default:m(()=>[d(s(ie),null,{default:m(()=>[a.value?(p(),y(s(_),{key:0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},class:D(f.value.overlay({class:[e.ui?.overlay]}))},null,8,["class"])):R("",!0),a.value?(p(),T("div",{key:1,class:D(f.value.content({class:[e.ui?.content]})),onClick:l},[d(s(_),{"as-child":"","layout-id":n.value,transition:{type:"spring",bounce:.15,duration:.5,ease:"easeInOut"}},{default:m(()=>[d(s(u))]),_:1},8,["layout-id"])],10,re)):R("",!0)]),_:2},1024)]),_:2},1024)]),_:1},8,["open"])):(p(),y(s(v),{key:1}))],64))}});export{pe as default};
